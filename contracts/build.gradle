def zepplinDir = "$buildDir/openzeppelin"
def contractsDir = "$zepplinDir/contracts/"

def cloneRepo = {name, repo, repoDir, tag ->
  task "clone${name.capitalize()}" {
    group "Clone Repo"
    description "Clone $name"
    doLast {
        exec {
            workingDir projectDir
            commandLine "git", "clone", repo, repoDir
            ignoreExitValue true
        }
        exec {
            workingDir repoDir
            commandLine "git", "checkout", tag
            ignoreExitValue true
        }
    }
    outputs.dir repoDir
  }
}

cloneRepo(
  'balancer-core',
  "https://github.com/balancer-labs/balancer-core.git",
  file("$buildDir/balancer-core"),
  'v1.0.0')


cloneRepo(
  'openzeppelin',
  "https://github.com/OpenZeppelin/openzeppelin-contracts.git",
  file(zepplinDir),
  'v3.2.1-solc-0.7')
